function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }
function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }
function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }
function _iterableToArrayLimit(r, l) { var t = null == r ? null : "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t["return"] && (u = t["return"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }
function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }
import { useEffect, useMemo, useState } from 'react';
import { PaymentRequestButtonElement, useStripe } from '@stripe/react-stripe-js';
import { jsx as _jsx } from "react/jsx-runtime";
function useOptions(paymentRequest) {
  var options = useMemo(function () {
    return {
      paymentRequest: paymentRequest,
      style: {
        paymentRequestButton: {
          theme: 'dark',
          height: '48px',
          type: 'buy'
        }
      }
    };
  }, [paymentRequest]);
  return options;
}
function usePaymentRequest(_ref) {
  var options = _ref.options,
    onPaymentMethod = _ref.onPaymentMethod;
  var stripe = useStripe();
  var _useState = useState(null),
    _useState2 = _slicedToArray(_useState, 2),
    paymentRequest = _useState2[0],
    setPaymentRequest = _useState2[1];
  var _useState3 = useState(false),
    _useState4 = _slicedToArray(_useState3, 2),
    canMakePayment = _useState4[0],
    setCanMakePayment = _useState4[1];
  useEffect(function () {
    if (stripe && paymentRequest === null) {
      var pr = stripe.paymentRequest(options);
      setPaymentRequest(pr);
    }
  }, [stripe, options, paymentRequest]);
  useEffect(function () {
    var subscribed = true;
    if (paymentRequest) {
      paymentRequest.canMakePayment().then(function (res) {
        if (res && subscribed) {
          setCanMakePayment(true);
        }
      });
    }
    return function () {
      subscribed = false;
    };
  }, [paymentRequest]);
  useEffect(function () {
    if (paymentRequest) {
      paymentRequest.on('paymentmethod', onPaymentMethod);
    }
    return function () {
      if (paymentRequest) {
        paymentRequest.off('paymentmethod', onPaymentMethod);
      }
    };
  }, [paymentRequest, onPaymentMethod]);
  return canMakePayment ? paymentRequest : null;
}
function StripePaymentButtons(_ref2) {
  var doPaymentRequest = _ref2.doPaymentRequest,
    invoice = _ref2.invoice;
  var paymentRequest = usePaymentRequest({
    options: {
      country: invoice.domain.company.country,
      currency: String(invoice.currency).toLowerCase(),
      total: {
        label: "Merchi Invoice #".concat(invoice.id),
        amount: Math.round(invoice.totalCost * 100)
      }
    },
    onPaymentMethod: doPaymentRequest
  });
  var options = useOptions(paymentRequest);
  if (!paymentRequest) {
    return null;
  }
  return /*#__PURE__*/_jsx("div", {
    style: {
      marginBottom: '2rem',
      marginTop: '2rem'
    },
    children: /*#__PURE__*/_jsx(PaymentRequestButtonElement, {
      className: "PaymentRequestButton",
      options: options
    })
  });
}
export default StripePaymentButtons;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VFZmZlY3QiLCJ1c2VNZW1vIiwidXNlU3RhdGUiLCJQYXltZW50UmVxdWVzdEJ1dHRvbkVsZW1lbnQiLCJ1c2VTdHJpcGUiLCJqc3giLCJfanN4IiwidXNlT3B0aW9ucyIsInBheW1lbnRSZXF1ZXN0Iiwib3B0aW9ucyIsInN0eWxlIiwicGF5bWVudFJlcXVlc3RCdXR0b24iLCJ0aGVtZSIsImhlaWdodCIsInR5cGUiLCJ1c2VQYXltZW50UmVxdWVzdCIsIl9yZWYiLCJvblBheW1lbnRNZXRob2QiLCJzdHJpcGUiLCJfdXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkiLCJzZXRQYXltZW50UmVxdWVzdCIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiY2FuTWFrZVBheW1lbnQiLCJzZXRDYW5NYWtlUGF5bWVudCIsInByIiwic3Vic2NyaWJlZCIsInRoZW4iLCJyZXMiLCJvbiIsIm9mZiIsIlN0cmlwZVBheW1lbnRCdXR0b25zIiwiX3JlZjIiLCJkb1BheW1lbnRSZXF1ZXN0IiwiaW52b2ljZSIsImNvdW50cnkiLCJkb21haW4iLCJjb21wYW55IiwiY3VycmVuY3kiLCJTdHJpbmciLCJ0b0xvd2VyQ2FzZSIsInRvdGFsIiwibGFiZWwiLCJjb25jYXQiLCJpZCIsImFtb3VudCIsIk1hdGgiLCJyb3VuZCIsInRvdGFsQ29zdCIsIm1hcmdpbkJvdHRvbSIsIm1hcmdpblRvcCIsImNoaWxkcmVuIiwiY2xhc3NOYW1lIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL3N0cmlwZS9TdHJpcGVQYXltZW50QnV0dG9ucy50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG4gIENhbk1ha2VQYXltZW50UmVzdWx0LFxuICBQYXltZW50UmVxdWVzdCxcbiAgUGF5bWVudFJlcXVlc3RPcHRpb25zLFxuICBQYXltZW50UmVxdWVzdFBheW1lbnRNZXRob2RFdmVudCxcbiAgU3RyaXBlUGF5bWVudFJlcXVlc3RCdXR0b25FbGVtZW50T3B0aW9ucyBcbn0gZnJvbSAnQHN0cmlwZS9zdHJpcGUtanMnO1xuaW1wb3J0IHtcbiAgUGF5bWVudFJlcXVlc3RCdXR0b25FbGVtZW50LFxuICB1c2VTdHJpcGUsXG59IGZyb20gJ0BzdHJpcGUvcmVhY3Qtc3RyaXBlLWpzJztcblxuXG5mdW5jdGlvbiB1c2VPcHRpb25zKHBheW1lbnRSZXF1ZXN0OiBQYXltZW50UmVxdWVzdCkge1xuICBjb25zdCBvcHRpb25zID0gdXNlTWVtbyhcbiAgICAoKSA9PiAoe1xuICAgICAgcGF5bWVudFJlcXVlc3QsXG4gICAgICBzdHlsZToge1xuICAgICAgICBwYXltZW50UmVxdWVzdEJ1dHRvbjoge1xuICAgICAgICAgIHRoZW1lOiAnZGFyaycsXG4gICAgICAgICAgaGVpZ2h0OiAnNDhweCcsXG4gICAgICAgICAgdHlwZTogJ2J1eSdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIFtwYXltZW50UmVxdWVzdF1cbiAgKTtcblxuICByZXR1cm4gb3B0aW9ucztcbn1cblxuaW50ZXJmYWNlIFVzZVBheW1lbnRSZXF1ZXN0IHtcbiAgb25QYXltZW50TWV0aG9kOiAocGF5bG9hZDogYW55KSA9PiB2b2lkO1xuICBvcHRpb25zOiBQYXltZW50UmVxdWVzdE9wdGlvbnM7XG59XG5cbmZ1bmN0aW9uIHVzZVBheW1lbnRSZXF1ZXN0KHsgb3B0aW9ucywgb25QYXltZW50TWV0aG9kIH06IFVzZVBheW1lbnRSZXF1ZXN0KSB7XG4gIGNvbnN0IHN0cmlwZSA9IHVzZVN0cmlwZSgpO1xuICBjb25zdCBbcGF5bWVudFJlcXVlc3QsIHNldFBheW1lbnRSZXF1ZXN0XSA9IHVzZVN0YXRlKChudWxsIGFzIHVua25vd24pKTtcbiAgY29uc3QgW2Nhbk1ha2VQYXltZW50LCBzZXRDYW5NYWtlUGF5bWVudF0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoc3RyaXBlICYmIHBheW1lbnRSZXF1ZXN0ID09PSBudWxsKSB7XG4gICAgICBjb25zdCBwciA9IHN0cmlwZS5wYXltZW50UmVxdWVzdChvcHRpb25zKTtcbiAgICAgIHNldFBheW1lbnRSZXF1ZXN0KChwciBhcyBhbnkpKTtcbiAgICB9XG4gIH0sIFtzdHJpcGUsIG9wdGlvbnMsIHBheW1lbnRSZXF1ZXN0XSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBsZXQgc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgaWYgKHBheW1lbnRSZXF1ZXN0KSB7XG4gICAgICAocGF5bWVudFJlcXVlc3QgYXMgUGF5bWVudFJlcXVlc3QpLmNhbk1ha2VQYXltZW50KCkudGhlbihcbiAgICAgICAgKHJlczogQ2FuTWFrZVBheW1lbnRSZXN1bHQgfCBudWxsKSA9PiB7XG4gICAgICAgICAgaWYgKHJlcyAmJiBzdWJzY3JpYmVkKSB7XG4gICAgICAgICAgICBzZXRDYW5NYWtlUGF5bWVudCh0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBzdWJzY3JpYmVkID0gZmFsc2U7XG4gICAgfTtcbiAgfSwgW3BheW1lbnRSZXF1ZXN0XSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocGF5bWVudFJlcXVlc3QpIHtcbiAgICAgIChwYXltZW50UmVxdWVzdCBhcyBhbnkpLm9uKCdwYXltZW50bWV0aG9kJywgb25QYXltZW50TWV0aG9kKTtcbiAgICB9XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlmIChwYXltZW50UmVxdWVzdCkge1xuICAgICAgICAocGF5bWVudFJlcXVlc3QgYXMgYW55KS5vZmYoJ3BheW1lbnRtZXRob2QnLCBvblBheW1lbnRNZXRob2QpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtwYXltZW50UmVxdWVzdCwgb25QYXltZW50TWV0aG9kXSk7XG5cbiAgcmV0dXJuIGNhbk1ha2VQYXltZW50ID8gcGF5bWVudFJlcXVlc3QgOiBudWxsO1xufVxuXG5pbnRlcmZhY2UgUHJvcHNTdHJpcGVQYXltZW50QnV0dG9ucyB7XG4gIGRvUGF5bWVudFJlcXVlc3Q6IChldmVudDogUGF5bWVudFJlcXVlc3RQYXltZW50TWV0aG9kRXZlbnQpID0+IHZvaWQ7XG4gIGludm9pY2U6IGFueTtcbn1cblxuZnVuY3Rpb24gU3RyaXBlUGF5bWVudEJ1dHRvbnMoXG4gIHtcbiAgICBkb1BheW1lbnRSZXF1ZXN0LFxuICAgIGludm9pY2UsXG4gIH06IFByb3BzU3RyaXBlUGF5bWVudEJ1dHRvbnMpIHtcbiAgY29uc3QgcGF5bWVudFJlcXVlc3Q6IHVua25vd24gPSB1c2VQYXltZW50UmVxdWVzdCh7XG4gICAgb3B0aW9uczoge1xuICAgICAgY291bnRyeTogaW52b2ljZS5kb21haW4uY29tcGFueS5jb3VudHJ5LFxuICAgICAgY3VycmVuY3k6IFN0cmluZyhpbnZvaWNlLmN1cnJlbmN5KS50b0xvd2VyQ2FzZSgpLFxuICAgICAgdG90YWw6IHtcbiAgICAgICAgbGFiZWw6IGBNZXJjaGkgSW52b2ljZSAjJHtpbnZvaWNlLmlkfWAsXG4gICAgICAgIGFtb3VudDogTWF0aC5yb3VuZChpbnZvaWNlLnRvdGFsQ29zdCAqIDEwMClcbiAgICAgIH1cbiAgICB9LFxuICAgIG9uUGF5bWVudE1ldGhvZDogZG9QYXltZW50UmVxdWVzdFxuICB9KTtcbiAgY29uc3Qgb3B0aW9ucyA9IHVzZU9wdGlvbnMoKHBheW1lbnRSZXF1ZXN0IGFzIFBheW1lbnRSZXF1ZXN0KSk7XG5cbiAgaWYgKCFwYXltZW50UmVxdWVzdCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiAoXG4gICAgPGRpdiBzdHlsZT17e21hcmdpbkJvdHRvbTogJzJyZW0nLCBtYXJnaW5Ub3A6ICcycmVtJ319PlxuICAgICAgPFBheW1lbnRSZXF1ZXN0QnV0dG9uRWxlbWVudFxuICAgICAgICBjbGFzc05hbWU9J1BheW1lbnRSZXF1ZXN0QnV0dG9uJ1xuICAgICAgICBvcHRpb25zPXsob3B0aW9ucyBhcyBTdHJpcGVQYXltZW50UmVxdWVzdEJ1dHRvbkVsZW1lbnRPcHRpb25zKX1cbiAgICAgIC8+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0cmlwZVBheW1lbnRCdXR0b25zO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxTQUFTQSxTQUFTLEVBQUVDLE9BQU8sRUFBRUMsUUFBUSxRQUFRLE9BQU87QUFRcEQsU0FDRUMsMkJBQTJCLEVBQzNCQyxTQUFTLFFBQ0oseUJBQXlCO0FBQUMsU0FBQUMsR0FBQSxJQUFBQyxJQUFBO0FBR2pDLFNBQVNDLFVBQVVBLENBQUNDLGNBQThCLEVBQUU7RUFDbEQsSUFBTUMsT0FBTyxHQUFHUixPQUFPLENBQ3JCO0lBQUEsT0FBTztNQUNMTyxjQUFjLEVBQWRBLGNBQWM7TUFDZEUsS0FBSyxFQUFFO1FBQ0xDLG9CQUFvQixFQUFFO1VBQ3BCQyxLQUFLLEVBQUUsTUFBTTtVQUNiQyxNQUFNLEVBQUUsTUFBTTtVQUNkQyxJQUFJLEVBQUU7UUFDUjtNQUNGO0lBQ0YsQ0FBQztFQUFBLENBQUMsRUFDRixDQUFDTixjQUFjLENBQ2pCLENBQUM7RUFFRCxPQUFPQyxPQUFPO0FBQ2hCO0FBT0EsU0FBU00saUJBQWlCQSxDQUFBQyxJQUFBLEVBQWtEO0VBQUEsSUFBL0NQLE9BQU8sR0FBQU8sSUFBQSxDQUFQUCxPQUFPO0lBQUVRLGVBQWUsR0FBQUQsSUFBQSxDQUFmQyxlQUFlO0VBQ25ELElBQU1DLE1BQU0sR0FBR2QsU0FBUyxDQUFDLENBQUM7RUFDMUIsSUFBQWUsU0FBQSxHQUE0Q2pCLFFBQVEsQ0FBRSxJQUFnQixDQUFDO0lBQUFrQixVQUFBLEdBQUFDLGNBQUEsQ0FBQUYsU0FBQTtJQUFoRVgsY0FBYyxHQUFBWSxVQUFBO0lBQUVFLGlCQUFpQixHQUFBRixVQUFBO0VBQ3hDLElBQUFHLFVBQUEsR0FBNENyQixRQUFRLENBQUMsS0FBSyxDQUFDO0lBQUFzQixVQUFBLEdBQUFILGNBQUEsQ0FBQUUsVUFB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